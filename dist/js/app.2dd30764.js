(function(e){function t(t){for(var n,_,s=t[0],o=t[1],c=t[2],u=0,d=[];u<s.length;u++)_=s[u],Object.prototype.hasOwnProperty.call(a,_)&&a[_]&&d.push(a[_][0]),a[_]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var o=r[s];0!==a[o]&&(n=!1)}n&&(i.splice(t--,1),e=_(_.s=r[0]))}return e}var n={},a={app:0},i=[];function _(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,_),r.l=!0,r.exports}_.m=e,_.c=n,_.d=function(e,t,r){_.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},_.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},_.t=function(e,t){if(1&t&&(e=_(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(_.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)_.d(r,n,function(t){return e[t]}.bind(null,n));return r},_.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return _.d(t,"a",t),t},_.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},_.p="/graf-view/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=o;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"199c":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("cb29"),core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("4de4"),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("c740"),core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("d81d"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("a434"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7__),C_Users_Yaroslav_Desktop_vue_graf_view_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("d4ec"),_components_Main__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("2614");__webpack_exports__["a"]={name:"App",components:{Main:_components_Main__WEBPACK_IMPORTED_MODULE_9__["a"]},created:function(){},mounted:function mounted(){var _this=this,nodes=eval(localStorage.nodes);nodes.forEach((function(e,t){var r=new Node(t,e.map((function(e,t){if(e)return t})).filter((function(e){return void 0!=e})));_this.list.push({tree:r})}))},data:function(){return{reload:!1,params:{gamma:2,l0:200,k:1,q2:100},list:[],drawer:!1}},computed:{tree:function(){return this.list.map((function(e){return e.tree}))}},methods:{test:function(){console.log("clci");var e=new Node(0,[1,3,5,4]);this.list.push({tree:e}),e=new Node(1,[0,2]),this.list.push({tree:e}),e=new Node(2,[1,5]),this.list.push({tree:e}),e=new Node(3,[1]),this.list.push({tree:e}),e=new Node(4,[1]),this.list.push({tree:e}),e=new Node(5,[1,2]),this.list.push({tree:e})},NodesToArrayIdNot:function(e){return this.tree.filter((function(t){return t.id!=e})).map((function(e){return e.id}))},NodesToArrayId:function(){return this.tree.map((function(e){return e.id}))},select:function(e,t){this.tree.filter((function(r){return r.id!=t&&-1===e.indexOf(r.id)})).map((function(e){return e.child=e.child.filter((function(e){return e!=t})),e})),e.length>0&&-1===this.tree.filter((function(t){return t.id==e[e.length-1]}))[0].child.indexOf(t)&&this.tree.filter((function(t){return t.id==e[e.length-1]}))[0].child.push(t)},nodes:function(){var e=this,t=[];return this.tree.forEach((function(r){t.push(e.getRow(r.id))})),t},getRow:function(e){var t=new Array(this.tree.length).fill(0);return t[e]=null,this.tree[e].child.forEach((function(e){t[e]=1})),t},add:function(){var e=Math.max.apply(null,this.NodesToArrayId())+1;isFinite(e)||(e=0);var t=new Node(e,[]);this.list.push({tree:t})},save:function(){localStorage.nodes=JSON.stringify(this.nodes())},del:function(e){this.list.splice(this.tree.findIndex((function(t){return t.id==e})),1),this.list.forEach((function(t){t.tree.child=t.tree.child.filter((function(t){return t!=e}))}))}}};var Node=function e(t,r){Object(C_Users_Yaroslav_Desktop_vue_graf_view_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_8__["a"])(this,e),this.id=t,this.child=r}},2614:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("canvas",{ref:"canvas"}),e._v(" "+e._s(e.nodes())+"::: "+e._s(e.n)+" ")])},a=[],i=(r("99af"),r("cb29"),r("c740"),r("4160"),r("b0c0"),r("159b"),r("bee2")),_=r("d4ec"),s=r("ade3"),o={name:"Main",data:function(){return{Toloop:0,dt:.004,size:800,vmax:80,frames:1e3}},props:{reload:Boolean,tree:Array,params:Object},beforeCreate:function(){},created:function(){0==this.Toloop&&(requestAnimationFrame(this.loop),console.log("lopp"))},mounted:function(){console.log("mounted"),this.canvas=new c(this.$refs.canvas),this.update()},beforeUpdate:function(){console.log("beforeUpdate"),this.update()},updated:function(){console.log("updated")},watch:{params:{handler:function(){this.update()},deep:!0},reload:function(){this.update()}},methods:{update:function(){this.graph=new l(this.nodes());var e=this.rndPoss(this.n,this.size/2,!0),t=this.rndPoss(this.n,this.vmax,!1);this.ps=new u(this.model(),this.dt).init(e,t)},model:function(){return this.ForceFrictionModel(this.LogSpringChargeForce(this.graph,this.params),this.SquareForce(this.params.gamma))},nodes:function(){var e=this,t=[];return this.tree.forEach((function(r,n){t.push(e.getRow(r.id,n))})),this.n=t.length,t},getRow:function(e,t){var r=this,n=new Array(this.tree.length).fill(0);return this.tree[t].child.forEach((function(e){n[r.tree.findIndex((function(t){return t.id==e}))]=1})),n[t]=null,n},EdgeNodeForce:function(e,t,r){var n=e.getSize();return function(a){var i,_=new Array(2*n);for(i=0;i<n;++i)_[2*i]=_[2*i+1]=0;for(i=0;i<n;++i)for(var s=i+1;s<n;++s){var o=a[2*i]-a[2*s],c=a[2*i+1]-a[2*s+1],l=Math.sqrt(o*o+c*c);if(0!=l){var u=e.edge(i,s)?t(l):r(l),d=u*o/l,f=u*c/l;_[2*i]+=d,_[2*s]-=d,_[2*i+1]+=f,_[2*s+1]-=f}}return _}},ForceFrictionModel:function(e,t){return function(r,n){for(var a=r.length/2,i=e(r),_=0;_<a;++_){var s=Math.sqrt(n[2*_]*n[2*_]+n[2*_+1]*n[2*_+1]);0!=s&&(i[2*_]-=t(s)*n[2*_]/s,i[2*_+1]-=t(s)*n[2*_+1]/s)}return i}},LogSpringChargeForce:function(e,t){var r=t.l0,n=t.k,a=t.q2;return this.EdgeNodeForce(e,(function(e){return a/(e*e)-n*Math.log(e/r)}),(function(e){return a/(e*e)}))},SquareForce:function(e){return function(t){return e*t*t}},centralize:function(e,t,r){for(var n=0,a=0,i=e.length/2,_=0;_<i;++_)n+=e[2*_],a+=e[2*_+1];n/=i,a/=i;for(var s=[].concat(e),o=0;o<i;++o)s[2*o]+=t-n,s[2*o+1]+=r-a;return s},rndPoss:function(e,t,r){for(var n=new Array(2*e),a=0;a<2*e;++a)n[a]=r?Math.random()*t:2*Math.random()*t-t;return n},stablePoint:function(e,t){t||(t={K0:1e-6,dK:.01,a:3/4,b:3});var r=t.K0,n=t.dK,a=t.a,i=t.b;if(!r||!n||!a||!i)throw"invalid parameters";e.step();var _=e.kinEnergy();e.step();var s=e.kinEnergy(),o=[],c=!0;do{e.step();var l=e.kinEnergy();s>_&&s>l&&(o.push(s),c=u()),_=s,s=l}while(c||s>r||o[o.length-1]>n);function u(){for(var e=Math.floor(o.length*a);e<o.length;++e)if(o[e]>i*n)return!0;return!1}return e.state()},loop:function(){this.Toloop=1,this.canvas.clear();for(var e=0;e<this.frames;++e)this.ps.step();for(var t=this.centralize(this.ps.state(),this.size/2,this.size/2),r=0;r<this.n;++r)for(var n=r+1;n<this.n;++n)this.graph.edge(r,n)&&this.canvas.drawLine(t[2*r],t[2*r+1],t[2*n],t[2*n+1]);for(var a=0;a<t.length/2;a++)this.canvas.ctx.save(),this.canvas.ctx.shadowBlur=10,this.canvas.ctx.shadowColor="#333",this.canvas.drawCircle(t[2*a],t[2*a+1],20,"#000"),this.canvas.ctx.restore(),this.canvas.drawText(t[2*a],t[2*a+1]+8,this.tree[a].id);requestAnimationFrame(this.loop)}}},c=function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024;Object(_["a"])(this,e),Object(s["a"])(this,"drawBox",(function(e){r.ctx.save(),r.ctx.beginPath(),r.ctx.rect(e.x,e.y,e.szx,e.szy),e.c&&(r.ctx.fillStyle=e.color,r.ctx.fill()),e.s&&r.ctx.stroke(),r.ctx.addHitRegion({id:[e.n,r.name]}),r.ctx.restore()})),Object(s["a"])(this,"drawCircle",(function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r.ctx.save(),r.ctx.beginPath(),r.ctx.arc(e,t,n,0,2*Math.PI),r.ctx.fillStyle=a,r.ctx.strokeStyle=a,r.ctx.fill(),r.ctx.restore()})),Object(s["a"])(this,"drawLine",(function(e,t,n,a,i){r.ctx.save(),r.ctx.beginPath(),r.ctx.moveTo(e,t),r.ctx.lineTo(n,a),r.ctx.strokeStyle=i,r.ctx.stroke(),r.ctx.restore()})),Object(s["a"])(this,"drawText",(function(e,t,n){r.ctx.font="20px arial",r.ctx.textAlign="center",r.ctx.fillStyle="#fff",r.ctx.fillText(n,e,t)})),Object(s["a"])(this,"clear",(function(){r.ctx.clearRect(0,0,r.width,r.height)})),this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width=n,this.height=this.canvas.height=a},l=function(){function e(t){Object(_["a"])(this,e),Object(s["a"])(this,"getAdjacencyMatrix",(function(){return this.adj})),Object(s["a"])(this,"getSize",(function(){return this.n})),Object(s["a"])(this,"edge",(function(e,t){return this.adj[e][t]})),this.adj=t,this.n=this.adj.length}return Object(i["a"])(e,[{key:"checkAdjacencyMatrix",value:function(e){if(!e||!e.length)return!1;for(var t=e.length,r=0;r<t;++r)if(!e[r]||e[r].length!==t)return!1;return!0}},{key:"connected",value:function(){var e=this.getAdjacencyMatrix(),t=this.getSize(),r=[],n=[0];do{for(var a=n.pop(),i=0;i<t;++i)!r[i]&&e[a][i]&&(r[i]=!0,n.push(i))}while(n.length>0);for(var _=0;_<t;++_)if(!r[_])return!1;return!0}}]),e}(),u=function e(t,r){var n=this;Object(_["a"])(this,e),Object(s["a"])(this,"init",(function(e,t){e=[].concat(e),t=[].concat(t);var r=n.dt;function a(e,t){for(var n=e.length,a=0;a<n;++a)e[a]+=t[a]*r}var i=n.f;return{step:function(){var r=i(e,t);a(t,r),a(e,t)},state:function(){return e},kinEnergy:function(){for(var e=0,r=0;r<t.length;++r)e+=t[r]*t[r];return e/2}}})),this.f=t,this.dt=r},d=o,f=r("2877"),p=Object(f["a"])(d,n,a,!1,null,null,null);t["a"]=p.exports},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-navigation-drawer",{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-list-item",[r("v-list-item-content",[r("v-list-item-title",{staticClass:"title"},[e._v(" Graf ")]),r("v-list-item-subtitle",[e._v(" add item ")])],1)],1),r("v-divider"),[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:""}},e._l(e.list,(function(t,n){return r("v-card",{key:n},[r("v-container",{attrs:{fluid:"","grid-list-lg":""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs4:"","ml-3":""}},[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" "+e._s(t.tree.id)+" ")])],1),r("v-flex",{attrs:{xs6:"",row:""}},[r("v-flex",{staticClass:"pa-1",attrs:{xs11:""}},[r("v-select",{attrs:{"single-line":"",chipS:"",items:e.NodesToArrayIdNot(t.tree.id),label:"nodes",multiple:""},on:{input:function(r){return e.select(t.tree.child,t.tree.id)}},model:{value:t.tree.child,callback:function(r){e.$set(t.tree,"child",r)},expression:"item.tree.child"}})],1),r("v-flex",{staticClass:"pa-1",attrs:{xs1:""}},[r("v-icon",{on:{click:function(r){return e.del(t.tree.id)}}},[e._v("mdi-delete")])],1)],1)],1)],1)],1)})),1)],1)],r("v-divider"),r("v-text-field",{staticClass:"mx-2",attrs:{type:"number","append-icon":"mdi-plus red--text","prepend-icon":"mdi-minus green--text ",label:"Lenght"},on:{"click:append":function(t){e.params.l0+=10},"click:prepend":function(t){e.params.l0-=10}},model:{value:e.params.l0,callback:function(t){e.$set(e.params,"l0",e._n(t))},expression:"params.l0"}}),r("v-text-field",{staticClass:"mx-2",attrs:{type:"number","append-icon":"mdi-plus red--text","prepend-icon":"mdi-minus green--text ",label:"Gamma"},on:{"click:append":function(t){e.params.gamma+=.1},"click:prepend":function(t){e.params.gamma-=.1}},model:{value:e.params.gamma,callback:function(t){e.$set(e.params,"gamma",e._n(t))},expression:"params.gamma"}}),r("v-text-field",{staticClass:"mx-2",attrs:{type:"number","append-icon":"mdi-plus red--text","prepend-icon":"mdi-minus green--text ",label:"K"},on:{"click:append":function(t){e.params.k+=.1},"click:prepend":function(t){e.params.k-=.1}},model:{value:e.params.k,callback:function(t){e.$set(e.params,"k",e._n(t))},expression:"params.k"}}),r("v-text-field",{staticClass:"mx-2",attrs:{type:"number","append-icon":"mdi-plus red--text","prepend-icon":"mdi-minus green--text ",label:"q2"},on:{"click:append":function(t){e.params.q2+=10},"click:prepend":function(t){e.params.q2-=10}},model:{value:e.params.q2,callback:function(t){e.$set(e.params,"q2",e._n(t))},expression:"params.q2"}})],2),r("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[e.drawer?r("v-icon",{staticClass:"mr-4",on:{click:function(t){e.drawer=!e.drawer}}},[e._v("mdi-chevron-left")]):r("v-app-bar-nav-icon",{staticClass:"mr-4",on:{click:function(t){e.drawer=!e.drawer}}}),r("v-spacer"),r("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r("v-icon",e._g({on:{click:e.test}},n),[e._v("mdi-alpha-t-box-outline")])]}}])},[r("span",[e._v("Testing graf")])]),r("v-spacer"),r("v-icon",{staticClass:"mx-4",on:{click:function(t){e.reload=!e.reload}}},[e._v("mdi-reload")]),r("v-icon",{staticClass:"mx-4",on:{click:e.add}},[e._v("mdi-plus")]),r("v-icon",{staticClass:"mx-4",on:{click:e.save}},[e._v("mdi-content-save")])],1),r("v-content",[r("Main",{attrs:{tree:e.tree,params:e.params,reload:e.reload}})],1)],1)},i=[],_=r("199c"),s=_["a"],o=r("2877"),c=Object(o["a"])(s,a,i,!1,null,null,null),l=c.exports,u=r("ce5b"),d=r.n(u),f=(r("bf40"),r("2992")),p=r.n(f);n["default"].use(d.a);var h=new d.a({lang:{locales:{ru:p.a},current:"ru"}});n["default"].config.productionTip=!1,new n["default"]({vuetify:h,render:function(e){return e(l)}}).$mount("#app")}});
//# sourceMappingURL=app.2dd30764.js.map